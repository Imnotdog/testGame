# éŠæˆ²ä¿®æ”¹æ­·å²è¨˜éŒ„ (Change History)

## 2025-12-05

### è­·ç›¾è¡æ“Šæ³¢æ“´æ•£æ•ˆæžœ (2025-12-05 16:28)
**ä¿®æ”¹å…§å®¹**ï¼š
- è­·ç›¾åªé¡¯ç¤ºè¢«æ”»æ“Šçš„æ‰‡å€ï¼ˆä¸å†å…¨éƒ¨äº®èµ·ï¼‰
- å¾žæ“Šä¸­é»žå‘å¤–æ“´æ•£çš„æ³¢ç´‹æ•ˆæžœ
- è­·ç›¾ç ´è£‚çš„æ‰‡å€ä¸é¡¯ç¤ºè¡æ“Šæ³¢
- æ³¢ç´‹åˆ°é”è­·ç›¾é‚Šç·£æ™‚æ›´äº®ç™½
- è­·ç›¾é¡è‰²æ ¹æ“šæ‰‡å€å¥åº·åº¦è®ŠåŒ–ï¼š
  - è—è‰²ï¼ˆ>60%ï¼‰
  - æ©™è‰²ï¼ˆ30-60%ï¼‰
  - ç´…è‰²ï¼ˆ<30%ï¼‰
- æ³¢ç´‹æŒçºŒ 1.5 ç§’å¾Œæ·¡å‡º

---

### è­·ç›¾æ‰‡å€ UI æŒ‡ç¤ºå™¨ (2025-12-05 15:52)
**ä¿®æ”¹å…§å®¹**ï¼š
- å·¦ä¸‹è§’æ–°å¢žè­·ç›¾æ‰‡å€é¡¯ç¤ºå™¨
- ç°¡å–®çš„é£›èˆ¹è¼ªå»Šåœ–ç¤ºï¼Œä¸Šä¸‹å·¦å³å››å€‹æ–¹å‘é¡¯ç¤ºè­·ç›¾æ¢
- è­·ç›¾æ¢é¡è‰²æ ¹æ“šå¥åº·åº¦è®ŠåŒ–ï¼šè—ï¼ˆå¥åº·ï¼‰â†’ æ©™ï¼ˆä¸­ç­‰ï¼‰â†’ ç´…ï¼ˆä½Žï¼‰

---

### è­·ç›¾èˆ‡èˆ¹é«” Hitbox åˆ†é›¢ (2025-12-05 15:46)
**ä¿®æ”¹å…§å®¹**ï¼š
- è­·ç›¾ hitboxï¼ˆradius * 4 = 54ï¼‰å’ŒçŽ©å®¶èˆ¹é«” hitboxï¼ˆradius = 13.5ï¼‰åˆ†é–‹åˆ¤å®š
- å¦‚æžœæ”»æ“Šæ–¹å‘çš„è­·ç›¾æ‰‡å€å·²æ­¸é›¶ï¼Œå­å½ˆæœƒç©¿é€è­·ç›¾ç›´æŽ¥æ‰“åˆ°èˆ¹é«”
- åªæœ‰è©²æ–¹å‘æœ‰è­·ç›¾æ™‚æ‰æœƒè¢«è­·ç›¾æ“‹ä½

---

### è­·ç›¾é¡¯ç¤ºå„ªåŒ– (2025-12-05 15:38)
**ä¿®æ”¹å…§å®¹**ï¼š
- è­·ç›¾åªåœ¨å—æ“Šå¾Œ 2.5 ç§’å…§é¡¯ç¤ºï¼Œå¹³æ™‚éš±è—
- æ›´ä¹¾æ·¨çš„è¦–è¦ºæ•ˆæžœï¼Œè­·ç›¾ä½œç‚ºå—æ“Šåé¥‹æ›´æ˜Žé¡¯

---

### æ•µäººç¸®æ”¾ (2025-12-05 15:32)
**ä¿®æ”¹å…§å®¹**ï¼š
- æ•µäºº hitbox ç¸®å° 1.5 å€ï¼ˆgrunt é¡žåž‹ï¼šradius * 2 / 1.5ï¼‰
- æ•µäººè²¼åœ–ç¸®å° 1.5 å€ï¼ˆæ‰€æœ‰æ•µäººé¡žåž‹çš„ sprite scaleï¼‰

---

### Hitbox èª¿æ•´ (2025-12-05 15:27)
**ä¿®æ”¹å…§å®¹**ï¼š
- é£›èˆ¹ hitbox æ“´å¤§è‡³ 1.5 å€ï¼ˆradius: 9 â†’ 13.5ï¼‰
- è­·ç›¾è¦–è¦ºç¯„åœè‡ªå‹•è·Ÿéš¨èª¿æ•´ï¼ˆç¾ç‚º radius * 4 = 54ï¼‰
- è­·ç›¾ä¿è­·ç¯„åœèˆ‡è¦–è¦ºç¯„åœä¸€è‡´
- **è­·ç›¾è¦–è¦ºæ¨£å¼æ¢å¾©**ï¼šæ¢å¾©åŽŸæœ¬çš„å…­é‚Šå½¢ç¶²æ ¼ç‰¹æ•ˆï¼ˆåƒè€ƒ shield_test.htmlï¼‰ï¼ŒåŒæ™‚ä¿ç•™ 4 æ‰‡å€å‚·å®³ç³»çµ±

---

### é‡è¦ä¿®æ”¹ï¼šéŠæˆ²æ©Ÿåˆ¶èª¿æ•´ï¼ˆæ ¹æ“šè€å¸«éœ€æ±‚ï¼‰

#### 1. é›·å°„ç³»çµ± (Laser System)
**ä¿®æ”¹å…§å®¹**ï¼š
- æ”¹ç‚ºã€Œçˆ†ç™¼æ¨¡å¼ã€ï¼šæŒçºŒ 0.5 ç§’ï¼Œå†·å» 10 ç§’
- ç§»é™¤èƒ½é‡ç³»çµ±ï¼ˆåŽŸæœ¬éœ€è¦å……èƒ½å’Œæ¶ˆè€—èƒ½é‡ï¼‰

**ä¿®æ”¹æª”æ¡ˆ**ï¼š
- `game/config.js`: æ–°å¢ž `burstDuration: 0.5`, `cooldown: 10`
- `game/states/gamestate.js`: é‡å¯«é›·å°„ç‹€æ…‹æ©Ÿï¼ˆ"ready" â†’ "firing" â†’ "cooldown"ï¼‰

#### 2. é­šé›·ç³»çµ± (Torpedo System)
**ä¿®æ”¹å…§å®¹**ï¼š
- é€Ÿåº¦æå‡è‡³é£›èˆ¹æœ€é«˜é€Ÿçš„ 3 å€ï¼ˆ1080ï¼‰
- å½ˆè—¥ç³»çµ±æ”¹ç‚ºå…±ç”¨å½ˆè—¥æ± ï¼š17 ç™¼ï¼ˆåŽŸ 12 å‰æ–¹ + 5 å¾Œæ–¹ï¼‰
- å½ˆè—¥å†ç”Ÿï¼šæ¯ç§’ 0.8 ç™¼
- æ–°å¢žå¾Œæ–¹ç™¼å°„åŠŸèƒ½ï¼ˆV éµï¼‰

**ä¿®æ”¹æª”æ¡ˆ**ï¼š
- `game/config.js`: é€Ÿåº¦ 1080, ammoMax: 17, regenPerSecond: 0.8
- `game/states/gamestate.js`: 
  - å‰æ–¹ç™¼å°„ï¼šZ éµï¼ŒæœƒéŽ–å®šç›®æ¨™
  - å¾Œæ–¹ç™¼å°„ï¼šV éµï¼Œå‘å¾Œç›´ç·šç™¼å°„ï¼ˆç„¡éŽ–å®šï¼‰

#### 3. è­·ç›¾ç³»çµ± (Shield System) âš ï¸ é‡è¦
**ä¿®æ”¹å…§å®¹**ï¼š
- **åˆ†å€è­·ç›¾**ï¼šè­·ç›¾åˆ†ç‚º 4 å€‹æ‰‡å€ï¼ˆå‰ã€å³ã€å¾Œã€å·¦ï¼‰
- **æ–¹å‘æ€§å‚·å®³**ï¼šæ ¹æ“šæ•µäººæ”»æ“Šæ–¹å‘ï¼Œåªæœ‰å°æ‡‰æ‰‡å€å—æ
- **éš¨æ©Ÿå‚·å®³å€¼**ï¼šæ¯æ¬¡å—æ“Šæ‰£é™¤æœ€å¤§è­·ç›¾çš„ 1/8 ~ 1/4ï¼ˆéš¨æ©Ÿï¼‰
- **è¦–è¦ºæ•ˆæžœ**ï¼šæ¯å€‹æ‰‡å€çš„äº®åº¦åæ˜ è©²æ‰‡å€çš„è¡€é‡

**ä¿®æ”¹æª”æ¡ˆ**ï¼š
- `game/states/gamestate.js`:
  - `createPlayer()`: æ–°å¢ž `shieldSectors` é™£åˆ— [front, right, back, left]
  - `applyDamageToPlayer()`: è¨ˆç®—æ”»æ“Šè§’åº¦ï¼Œæ±ºå®šå—ææ‰‡å€
  - `drawShieldFx()`: ç¹ªè£½ 4 å€‹å¼§å½¢æ‰‡å€ï¼ˆåŠå¾‘å¢žå¤§è‡³ `radius * 4` ä»¥è¦†è“‹å®Œæ•´è²¼åœ–ï¼‰

**å‚·å®³è¨ˆç®—é‚è¼¯**ï¼š
```javascript
// è¨ˆç®—æ”»æ“Šä¾†æºç›¸å°æ–¼é£›èˆ¹çš„è§’åº¦
const angleToSource = Math.atan2(-dirY, -dirX);
let relAngle = angleToSource - player.angle;
// æ­£è¦åŒ–åˆ° -PI ~ PI

// æ‰‡å€åŠƒåˆ†ï¼š
// Front (0): -45Â° ~ 45Â°
// Right (1): 45Â° ~ 135Â°
// Back (2): 135Â° ~ 225Â° (æˆ– -180Â° ~ -135Â°)
// Left (3): 225Â° ~ 315Â° (æˆ– -135Â° ~ -45Â°)

// éš¨æ©Ÿå‚·å®³å€¼
const shieldDmg = player.maxShield * (0.125 + Math.random() * 0.125); // 1/8 ~ 1/4
```

---

### ä¸€èˆ¬ä¿®æ”¹

#### é­šé›·é¡¯ç¤º
- åœ¨çŽ©å®¶é£›èˆ¹ä¸Šæ–¹é¡¯ç¤ºé­šé›·æ•¸é‡ï¼ˆå°å­—é«”ï¼Œä¸é¡¯çœ¼ï¼‰
- ä½ç½®ï¼šé£›èˆ¹ä¸Šæ–¹ 40 åƒç´ 

#### æª”æ¡ˆä¿®å¾©
- ä¿®å¾©äº† `gamestate.js` æ–‡ä»¶æå£žå•é¡Œï¼ˆç”±æ–¼ç·¨è¼¯éŒ¯èª¤å°Žè‡´çš„ï¼‰
- æ¢å¾©äº† `updateEnemyFacing()` å’Œ `computeEnemyTargetAngle()` å‡½æ•¸

---

### å·²çŸ¥å•é¡Œ (Known Issues)

#### ðŸ› Mid-tier Boss å´©æ½° (èª¿æŸ¥ä¸­)
**å•é¡Œ**ï¼šä¸­ç­‰æ–‡æ˜Žç¬¬ 3 é—œï¼ˆBoss é—œï¼‰é€²å…¥æ™‚éŠæˆ²å´©æ½°
**ç‹€æ…‹**ï¼šæ­£åœ¨èª¿æŸ¥ä¸­
**ç›¸é—œæª”æ¡ˆ**ï¼š
- `game/states/round_manager.js`: Round 3 spawns `mid_boss_core`
- `game/states/gamestate.js`: `mid_boss` behavior implementation

**åˆæ­¥åˆ†æž**ï¼š
- Boss æœ‰ 4 å€‹éšŽæ®µï¼štorp, rain, clamp, ultimate
- å¯èƒ½åŽŸå› ï¼šæŸå€‹éšŽæ®µçš„é‚è¼¯æœ‰å•é¡Œï¼Œæˆ–è€…è³‡æºè¼‰å…¥å¤±æ•—

---

### å¾…æ”¹é€²é …ç›® (TODO)

1. **è­·ç›¾è¦–è¦ºæ•ˆæžœ**ï¼šç›®å‰ä½¿ç”¨ç°¡å–®å¼§å½¢ï¼Œå¯è€ƒæ…®æ¢å¾©åŽŸæœ¬çš„å…­é‚Šå½¢ç¶²æ ¼ç‰¹æ•ˆ
2. **Boss å´©æ½°ä¿®å¾©**ï¼šéœ€è¦å®Œæˆä¸­ç­‰æ–‡æ˜Ž Boss çš„èª¿è©¦
3. **å½ˆè—¥é¡¯ç¤ºå„ªåŒ–**ï¼šç¢ºèªé­šé›·æ•¸é‡é¡¯ç¤ºä½ç½®æ˜¯å¦éœ€è¦èª¿æ•´

---

## æŠ€è¡“ç´°ç¯€å‚™è¨»

### è­·ç›¾æ‰‡å€è§’åº¦è¨ˆç®—
ç”±æ–¼éŠæˆ²ä¸­é£›èˆ¹çš„è§’åº¦ç³»çµ±ç‚ºï¼š
- 0 rad = å‘ä¸Šï¼ˆåŒ—ï¼‰
- é †æ™‚é‡æ—‹è½‰ç‚ºæ­£

å› æ­¤æ‰‡å€åŠƒåˆ†éœ€è¦è€ƒæ…®é£›èˆ¹ç•¶å‰æœå‘ï¼š
```javascript
const relAngle = angleToSource - player.angle; // ç›¸å°è§’åº¦
```

### é­šé›·è»Œè·¡
- å‰æ–¹é­šé›·ï¼šæœƒä¸»å‹•è¿½è¹¤éŒå½¢ç¯„åœå…§æœ€è¿‘çš„æ•µäºº
- å¾Œæ–¹é­šé›·ï¼šç›´ç·šç™¼å°„ï¼Œç„¡è¿½è¹¤åŠŸèƒ½
